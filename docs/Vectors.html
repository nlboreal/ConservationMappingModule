<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Working with Vector Data | Mapping Module for Conservation Biology II (BIOL 4651/7944)</title>
  <meta name="description" content="This is a set of instructions for a mapping module in the BIOL 4651/7944 Conservation in Practice Course" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Working with Vector Data | Mapping Module for Conservation Biology II (BIOL 4651/7944)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a set of instructions for a mapping module in the BIOL 4651/7944 Conservation in Practice Course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Working with Vector Data | Mapping Module for Conservation Biology II (BIOL 4651/7944)" />
  
  <meta name="twitter:description" content="This is a set of instructions for a mapping module in the BIOL 4651/7944 Conservation in Practice Course" />
  

<meta name="author" content="Yolanda Wiersma" />


<meta name="date" content="2021-11-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Downloading.html"/>
<link rel="next" href="AreaAnalysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Conservation Mapping Module</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Downloading.html"><a href="Downloading.html"><i class="fa fa-check"></i><b>2</b> Downlaoding Data</a></li>
<li class="chapter" data-level="3" data-path="Vectors.html"><a href="Vectors.html"><i class="fa fa-check"></i><b>3</b> Working with Vector Data</a></li>
<li class="chapter" data-level="4" data-path="AreaAnalysis.html"><a href="AreaAnalysis.html"><i class="fa fa-check"></i><b>4</b> Area Analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mapping Module for Conservation Biology II (BIOL 4651/7944)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Vectors" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Working with Vector Data</h1>
<p>We will use the R package <code>sf</code> for handling vector data. You will have to download and install this package from the CRAN repository (review section <a href="https://ahurford.github.io/quant-guide-all-courses/rintro.html#r-packages">4.10</a> of the MUN Biology R manual if need a reminder of how to do this).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="Vectors.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-projct.org&quot;</span>)</span></code></pre></div>
<pre><code>## Installing package into &#39;C:/Users/ywiersma/Documents/R/win-library/4.1&#39;
## (as &#39;lib&#39; is unspecified)</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="Vectors.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) </span></code></pre></div>
<pre><code>## Linking to GEOS 3.9.1, GDAL 3.2.1, PROJ 7.2.1</code></pre>
<p>To plot the data (i.e., make a map) we will also need the package <code>ggplot2</code>, so make sure to load and install that as well.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Vectors.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-projct.org&quot;</span>)</span></code></pre></div>
<pre><code>## Installing package into &#39;C:/Users/ywiersma/Documents/R/win-library/4.1&#39;
## (as &#39;lib&#39; is unspecified)</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="Vectors.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Set your working directory to the spot where you downloaded the data in the previous chapter <a href="Downloading.html#Downloading">2</a>. If you do not remember how to check, and set your working directory, review section <a href="https://ahurford.github.io/quant-guide-all-courses/rintro.html#working-directory">4.2</a>.</p>
<p>Then read in the shapefile for the boundary outline of the province of Manitoba, the provincial parks layer and the Aboriginal lands layer as follows (note that you may have to change the file path and file names if you named them differently when you downloaded. In the text below, my GIS files are in a sub-folder named “GIS_MB”):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="Vectors.html#cb8-1" aria-hidden="true" tabindex="-1"></a>MB_outline <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;GIS_MB/Manitoba_Provincial_Boundary.shp&quot;</span>)</span>
<span id="cb8-2"><a href="Vectors.html#cb8-2" aria-hidden="true" tabindex="-1"></a>MB_parks <span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;GIS_MB/Manitoba_Parks.shp&quot;</span>)</span></code></pre></div>
<p><code>IndigenousLands &lt;- st_read("Aboriginal_Lands.shp")</code></p>
<p>Create a map of the province of Manitoba boundary and the Indigenous lands layers using ggplot using the code snippet below:</p>
<pre><code>ggplot() +
  geom_sf(data = MB_outline) + 
  geom_sf(data = IndigenousLands)</code></pre>
<p>Notice that the Indigenous Lands layer is for all of Canada. To clip this to just include those within the province of Manitoba, execute this code:</p>
<pre><code>MB_IndigenousLands &lt;- IndigenousLands[MB_outline, ]</code></pre>
<p>If you substitute the new layer “MB_IndigenousLands” in the ggplot code snippet you used above, you will only see the lands that are within the provincial boundaries of Manitoba, and your map should look like this:</p>
<p><img src="Conservation-Mapping-Module_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Now add in the layer for provincial parks</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="Vectors.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-2"><a href="Vectors.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_outline) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="Vectors.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_IndigenousLands) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="Vectors.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_parks)</span></code></pre></div>
<p><img src="Conservation-Mapping-Module_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Now, try reading in and adding the layer for railways, using the code below:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="Vectors.html#cb12-1" aria-hidden="true" tabindex="-1"></a>MB_rail <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;GIS_MB/rail.shp&quot;</span>)</span>
<span id="cb12-2"><a href="Vectors.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-3"><a href="Vectors.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="Vectors.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_outline) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="Vectors.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_IndigenousLands) <span class="sc">+</span></span>
<span id="cb12-6"><a href="Vectors.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_parks) <span class="sc">+</span></span>
<span id="cb12-7"><a href="Vectors.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_rail)</span></code></pre></div>
<p>Note that you get an error message that says something about a missing crs. “crs” stand for “co-ordinate reference system”. This refers to how map data a projected to transform the round earth to a flat map. Read more about projections in the <a href="https://nlboreal.github.io/ConservationGIS/projections.html">ConservationGIS</a> module.</p>
<p>Verify that the MB_rail layer has no crs with the following code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="Vectors.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(MB_rail)</span></code></pre></div>
<pre><code>## Coordinate Reference System: NA</code></pre>
<p>Now use the same <code>st_crs</code> function to check the CRS for the MB_parks layer. Notice the code right at the IDend of the output. It is 26914, which is the reference code for that file’s projection (which is in NAD 83, UTM Zone 14N).</p>
<p>To assign the existing projection system for MB_parks to the MB_rail layer, execute the following code:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="Vectors.html#cb15-1" aria-hidden="true" tabindex="-1"></a>MB_rail <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(MB_rail, <span class="dv">26914</span>)</span></code></pre></div>
<p>Now try making the map with the provincial boundary, the Manitoba Indigenous lands layer and the rail layer.</p>
<p><img src="Conservation-Mapping-Module_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>This is starting to look like all the pieces are coming together, but it is hard to see the different features without some kind of colour coding or other symbology.</p>
<p>Details on how to change symbols can be viewed by typing <code>vignette("ggplot2-specs")</code> at the prompt.</p>
<p>An example to make the Indigenous lands yellow and the rail line a brown dashed line is below:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="Vectors.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-2"><a href="Vectors.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_outline) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="Vectors.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_IndigenousLands, <span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="Vectors.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_parks, <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="Vectors.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> MB_rail, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>)</span></code></pre></div>
<p><img src="Conservation-Mapping-Module_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Now, try reading in the following additional layers and symbolize them as listed. Your final map should look like the one below.</p>
<p><strong>NOTE</strong> if you run into CRS error messages, simply go through the steps above to fix them.</p>
<p><strong>NOTE</strong> pay attention to the order in which you read things into ggplot, so that your final map matches the one below.</p>
<p>Riding Mountain National Park - pink
Roads layer - red
Water layer - blue</p>
<p><img src="Conservation-Mapping-Module_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>In the chapter<a href="AreaAnalysis.html#AreaAnalysis">4</a>, we will explore how we can use the data underlying this map to do an area analysis.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="Downloading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="AreaAnalysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-MakingVectorMap.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Conservation Mapping Module.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
